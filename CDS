//////////////////////////////////// ANNOTAIONS IN CDS
@AbapCatalog.sqlViewName: 'ZCDS_SQL1'   --Normal View
@AccessControl.authorizationCheck: #CHECK --Authorization Check
@EndUserText.label: 'Simple CDS View'   --CDS Description
@AbapCatalog.buffering.status: #ACTIVE
@AbapCatalog.buffering.type: #SINGLE
@ClientHandling.type: #INHERITED --Automatic Client Handling
define view ZCDS_DDL1 as 
select from sbook
{
    carrid as airline_code,
    connid as airline_number,
    fldate as flight_date,
    bookid as booking_number,
    customid as cutomre_number,
    @Semantics.amount.currencyCode: 'local_currency'    
    loccuram as local_currency_amount,
    @Semantics.currencyCode: true
    loccurkey as local_currency
}





//////////////////////////////////// CASE Expressions in CDS
@AbapCatalog.sqlViewName: 'ZCDS_SLQ2'
@EndUserText.label: 'CASE Expressions'
define view ZCDS_DDL2
  as select from sbook
{
  carrid   as airline_code,
  bookid   as booking_number,
  customid as cutomer_number,
  custtype as customer_type,
  smoker   as smoker,
  loccuram as booking_amount,

  case smoker
      when 'X' then loccuram + 100
      else loccuram
  end      as inc_smoker_charge_1,

  case
      when smoker = 'X' and custtype = 'B' then loccuram + 200
      when smoker = 'X' and custtype = 'P' then loccuram + 100
      else loccuram
  end      as inc_smoker_charge_2,

  case smoker
      when ' ' then loccuram
      else
          case
              when smoker = 'X' and custtype = 'B' then loccuram + 200
              when smoker = 'X' and custtype = 'P' then loccuram + 100
              else loccuram
          end
   end as inc_smoker_charge_3

}





/////////////////////////////////////
